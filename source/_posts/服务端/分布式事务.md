---
title: 分布式事务解决方案Seata
date: 2022-06-22 10:21:50
toc: true
categories: "服务端"
tags: [分布式, 事务]
---
# 理论基础
## 1.CAP定理 
* Consistency(一致性)：用户访问分布式系统中的任意节点，得到的数据必须一致性
* Availability(可用性)：用户访问集群中的任意健康节点，必须能得到响应，而不是超时或拒绝
* Partition(分区)： 因为网络故障或其他原因导致分布式系统中的部分节点与其他节点失去连接，形成独立分区

分布式系统节点通过网络连接，一定会出现分区问题（P），当分区出现时，系统的一致性（C）和可用性（A）就无法同时满足
elasticsearch 集群是CP,ES集群休闲分区是，故障节点会被剔除集群，数据分片会重新分配到其他节点，保证数据的一致性，因此是低可用性，高一致性，属于CP

## 2.BASE理论
* Basically Available(基本可用)：分布式系统在出现故障时，允许损失部分性能，保证核心可用
* Soft State(软状态)：在一定时间内，允许出现中间状态，比如临时的不一致
* Eventually Consistent(最终一致性)： 虽然无法保证强一致性，但是在软状态结束后，最终达到数据一致

## 2.事务的ACID原则
 * A 原子性：事务中的所有操作，要么全部成功，要么全部失败
 * C 一致性：要保证数据库内部完整性约束、声明书约束
 * I 隔离性：对同一资源操作的事务不能同时发生
 * D 持久性：对数据库做的一切操作将永久修改，不管是否出现故障  

分布式事务最大打的问题是各个子事务的一致性问题，因此可以借鉴CAP定理和BASE理论：
* AP模式：各子事务分别执行提交，允许出现结果不一致，然后采用弥补措施恢复数据即可，实现**最终一致**
* CP模式：各子事务执行后互相等待，同时提交，同时回滚，达成**强一致**，但是事务等待过程中，处于弱可用状态

# 初识Seata

# 高可用